<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>오늘득템 - 중고거래의 새로운 시작</title>
<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

body {
	font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
		'Helvetica Neue', Arial, sans-serif;
	background-color: #ffffff;
	color: #333;
	padding-top: 100px;
	/* 인트로 효과를 위한 초기 설정 */
	overflow-x: hidden;
}
/* 인트로 오버레이 스타일 */
.intro-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background: linear-gradient(135deg, #3a5a40 0%, #2a3c34 100%);
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	z-index: 9999;
	opacity: 1;
	transition: opacity 1.5s ease-out;
}

.intro-overlay.hidden {
	opacity: 0;
	pointer-events: none;
}

.intro-logo {
	width: 500px;
	height: auto;
	object-fit: contain;
	margin-bottom: 2rem;
	animation: logoFadeIn 3s ease-in-out;
}

.intro-text {
	color: white;
	font-size: 2.0rem;
	text-align: center;
	line-height: 1.4;
	animation: textFadeIn 2s ease-in-out 0.3s both;
}

.intro-subtitle {
	color: rgba(255, 255, 255, 0.9);
	font-size: 2.2rem;
	font-weight: bold;
	margin-top: 1rem;
	animation: textFadeIn 2s ease-in-out 0.6s both;
}

/* 로고 페이드인 애니메이션 */
@keyframes logoFadeIn {
	0% {
		opacity: 0;
		transform: scale(0.5) translateY(50px);
	}
	50% {
		opacity: 1;
		transform: scale(1.1) translateY(0);
	}
	100% {
		opacity: 1;
		transform: scale(1) translateY(0);
	}
}

/* 텍스트 페이드인 애니메이션 */
@keyframes textFadeIn {
	0% {
		opacity: 0;
		transform: translateY(30px);
	}
	100% {
		opacity: 1;
		transform: translateY(0);
	}
}

/* 메인 콘텐츠 초기 숨김 */
.main-content {
	opacity: 0;
	transition: opacity 1s ease-in;
}

.main-content.visible {
	opacity: 1;
}

/* 검색 섹션 */
.search-section {
	width: 320px; 
	background: white;
	padding: 2rem 15px;
	text-align: center;
	box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
	border: 2px solid #3a5a40; 
	border-radius: 12px; 
}

.search-section h1 {
	font-size: 1.5rem;
	margin-bottom: 1rem;
	color: #3a5a40;
}

.search-section p {
	font-size: 1.1rem;
	color: #666;
	margin-bottom: 2rem;
}

.search-box { 
	display: flex;
	width: 100%;
	margin: auto;	
    gap: 3px;
}

.search-box input {
	flex: 1;
	padding: 10px 12px;
	border: 2px solid #e0e0e0;
	border-radius: 8px;
	font-size: 1rem;
	transition: border-color 0.3s;
}

.search-box input:focus {
	outline: none;
	border-color: #667eea;
}

.search-box button {
	padding: 10px 12px;
	background: #3a5a40;
	color: white;
	border: 2px solid #e0e0e0;
	border-left: none;
	border-radius: 8px;
	font-size: 1rem;
	font-weight: bold;
	cursor: pointer;
	transition: transform 0.2s;
	flex-shrink: 0;  
}

.search-box button:hover {
	transform: translateY(-2px);
}

/* 위치 선택 섹션 */
.location-section {
    text-align: left;
}

.location-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #3a5a40;
    margin-bottom: 0.5rem;
}

.location-box {
    display: flex;
    flex-direction: column; /* 세로 배치 */
    gap: 10px;
}

.location-box select {
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    color: #333;
    transition: border-color 0.3s;
}

.location-box select:focus {
    outline: none;
    border-color: #667eea;
}

.category-section h2 {
    font-size: 1.2rem;      
    font-weight: 600;
    color: #3a5a40;
    margin-bottom: 0.5rem;
}

.category-radio label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 1rem;
    color: #333; /* 검색창 글씨 색과 동일 */
    cursor: pointer;
}

.category-radio input[type="radio"] {
    margin-right: 8px;
    cursor: pointer;
}

.price-section h2 {
    font-size: 1.2rem; /* 위치/카테고리 제목과 동일 */
    font-weight: 600;
    color: #3a5a40;
    margin-bottom: 0.5rem;
}

.price-radio label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 1rem; /* 위치/카테고리 라디오와 동일 */
    color: #333;
    cursor: pointer;
}

.price-radio input[type="radio"] {
    margin-right: 8px;
    cursor: pointer;
}

.price-input input {
    font-size: 1rem;
    color: #333; /* 검색창과 동일 */
}

.price-input button:hover {
    transform: translateY(-2px);
}

/* 컨테이너 */
.container {
	max-width: 1200px;
	margin: 0 auto;
	padding: 3rem 20px;
}

.section-title {
    font-size: 1.6rem;
    font-weight: 600;
    color: #3a5a40; /* 카테고리 선택 타이틀 컬러와 동일 */
    margin-bottom: 0.5rem;
}

/* 최근 게시물 섹션 */
.recent-posts {
	margin-top: 3rem;
}

.posts-grid {
	display: grid;
	grid-template-columns: repeat(4, 190px);
	gap: 1.5rem;
	overflow-x: auto;  
	padding-bottom: 10px;
}

.posts-grid::-webkit-scrollbar {
	height: 6px; /* 스크롤바 높이 */
}
.posts-grid::-webkit-scrollbar-thumb {
	background: rgba(0,0,0,0.2);
	border-radius: 3px;
}
.posts-grid::-webkit-scrollbar-track {
	background: transparent;
}

.post-card {
	background: white;
	border-radius: 12px;
	overflow: hidden;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
	transition: all 0.3s;
	cursor: pointer;
	width: 100%;
	border: 1px solid #f0f0f0;
}

.post-card:hover {
	transform: translateY(-5px);
	box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
	border-color: #3a5a40;
}

.post-image {
	width: 100%;
	height: 200px;
	background: #e4f7dd;
	display: flex;
	align-items: center;
	justify-content: center;
	color: white;
	font-size: 3rem;
	overflow: hidden;
}

.post-image img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.post-content {
	padding: 1.2rem;
	display: flex;
	flex-direction: column;
	gap: 0.5rem;
}

.post-title {
	font-weight: 600;
	font-size: 1rem;
	color: #222;
	line-height: 1.4;
	height: 2.8rem;
	overflow: hidden;
	text-overflow: ellipsis;
	display: -webkit-box;
	-webkit-line-clamp: 2;
	-webkit-box-orient: vertical;
	word-break: break-word;
}

.post-location {
	font-size: 0.85rem;
	color: #666;
	display: flex;
	align-items: flex-start;
	gap: 0.3rem;
	line-height: 1.3;
	word-break: break-all;
}

.post-location span:first-child {
	flex-shrink: 0;
	margin-top: 1px;
}

.post-price {
	font-size: 1.4rem;
	font-weight: 700;
	color: #3a5a40;
	letter-spacing: -0.5px;
	padding-top: 0.3rem;
	border-top: 1px solid #f0f0f0;
}

.post-price.free {
	color: #ff6b6b;
	font-size: 1.2rem;
}

.post-wishlist {
	font-size: 0.85rem;
	color: #ff6b6b;
	font-weight: 500;
	display: flex;
	align-items: center;
	justify-content: flex-end;
	gap: 0.3rem;
}

/* 거래완료 상품 스타일 */
.post-card.sold {
	background: #f5f5f5;
	opacity: 0.8;
}

.post-card.sold .post-image {
	position: relative;
	filter: grayscale(30%);
}

.post-card.sold .post-image::after {
	content: '거래완료';
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	background: rgba(0, 0, 0, 0.7);
	color: white;
	padding: 0.8rem 1.5rem;
	border-radius: 8px;
	font-size: 1.2rem;
	font-weight: bold;
	z-index: 2;
}

.post-card.sold .post-title,
.post-card.sold .post-price {
	color: #999;
}

/* 더보기 링크 스타일 */
.more-link {
	font-size: 0.9rem;
	color: #3a5a40;
	text-decoration: none;
	font-weight: 500;
	transition: all 0.3s ease;
}

.more-link:hover {
	color: #2a4530;
	text-decoration: underline;
	transform: translateX(3px);
}

</style>
</head>
<body>
   <!-- 인트로 오버레이 -->
	<div class="intro-overlay" id="introOverlay">
		<div class="intro-text">
			오늘 득템을 내일로 미루지 말자<br>
			오늘 득템하는 재미
		</div>
		<img src="/images/logo3.png" alt="오늘득템 로고" class="intro-logo">
		<div class="intro-subtitle">믿을 수 있는 중고거래의 새로운 시작</div>
	</div>
   <div th:replace="~{layouts/header.html}"></div>

	<!-- 메인 컨텐츠 -->
	<div class="container" style="display: flex; gap: 2rem;">
		<!-- 좌측: 검색 섹션 -->
		<aside style="flex: 1;">
    <section class="search-section">
        <h1>오늘의 득템을 찾아보세요</h1>
        <p>
            믿을 수 있는 중고거래,<br> 오늘득템에서 시작하세요
        </p>
        
        <!-- 검색 폼 -->
        <form action="post/postList" method="get" id="frm">
            
            <!-- 검색어 입력 -->
            <div class="search-box">
                <input type="text" id="searchTitle" name="title" placeholder="어떤 상품을 찾으시나요?">
                <button type="submit">검색</button>
            </div>

            <!-- 한 줄 띄우기 -->
            <div style="height: 1.5rem;"></div>

            <!-- 위치 선택 영역 -->
            <div class="location-section">
                <h2 class="location-title">위치 선택</h2>
                <div class="location-box">
                    <select id="sido" name="sido">
                        <option value="">시/도 선택</option>
                    </select>
                    <select id="sigungu" name="sigungu" disabled>
                        <option value="">시/군/구 선택</option>
                    </select>
                    <select id="dong" name="dong" disabled>
                        <option value="">읍/면/동 선택</option>
                    </select>
                </div>
                <p class="form-help" style="margin-top: 0.5rem; font-size: 0.85rem; color: #999;">
                    * 시/도만 선택 시 해당 지역 전체, 시/군/구까지 선택 시 해당 구/시 전체 검색
                </p>
            </div>

            <!-- 카테고리 선택 영역 -->
            <div class="category-section" style="margin-top: 1.5rem; text-align: left;">
                <h2 class="location-title">카테고리 선택</h2>
                <fieldset class="category-radio" style="border: none; padding: 0; margin-top: 0.5rem;">
                    <label><input type="radio" name="category" value="" id="category-all" checked> 전체보기</label>
                    <label><input type="radio" name="category" value="디지털/가전" id="category-digital"> 디지털/가전</label>
                    <label><input type="radio" name="category" value="패션/잡화" id="category-fashion"> 패션/잡화</label>
                    <label><input type="radio" name="category" value="뷰티" id="category-beauty"> 뷰티</label>
                    <label><input type="radio" name="category" value="가구/인테리어" id="category-furniture"> 가구/인테리어</label>
                    <label><input type="radio" name="category" value="도서/문구" id="category-book"> 도서/문구</label>
                    <label><input type="radio" name="category" value="취미/게임" id="category-hobby"> 취미/게임</label>
                    <label><input type="radio" name="category" value="스포츠/레저" id="category-sports"> 스포츠/레저</label>
                    <label><input type="radio" name="category" value="유아동/출산" id="category-kids"> 유아동/출산</label>
                    <label><input type="radio" name="category" value="식품" id="category-food"> 식품</label>
                    <label><input type="radio" name="category" value="반려동물용품" id="category-pet"> 반려동물용품</label>
                    <label><input type="radio" name="category" value="기타" id="category-etc"> 기타</label>
                </fieldset>
            </div>

            <!-- 가격 선택 영역 -->
            <div class="price-section" style="margin-top: 1.5rem; text-align: left;">
                <h2 class="location-title">가격 선택</h2>
                
                <!-- 라디오 버튼 가격대 -->
                <fieldset class="price-radio" style="border: none; padding: 0; margin-top: 0.5rem;">
                    <label><input type="radio" name="priceRange" value="" id="price-all" checked onclick="disablePriceInput()"> 전체보기</label>
                    <label><input type="radio" name="priceRange" value="0" id="price-free" onclick="setPriceRange(0, 0)"> 나눔</label>
                    <label><input type="radio" name="priceRange" value="5000" id="price-5000" onclick="setPriceRange(0, 5000)"> 5,000원 이하</label>
                    <label><input type="radio" name="priceRange" value="10000" id="price-10000" onclick="setPriceRange(0, 10000)"> 10,000원 이하</label>
                    <label><input type="radio" name="priceRange" value="20000" id="price-20000" onclick="setPriceRange(0, 20000)"> 20,000원 이하</label>
                </fieldset>

                <!-- 직접 가격 입력 -->
                <div class="price-input" style="display: flex; gap: 5px; margin-top: 0.5rem;">
                    <input type="number" id="minPrice" name="minPrice" placeholder="최소가격" min="0"
                        style="padding: 8px 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; height: 38px; width: 100px;"
                        onclick="uncheckPriceRadio()">
                    <span style="align-self: center;">~</span>
                    <input type="number" id="maxPrice" name="maxPrice" placeholder="최대가격" min="0"
                        style="padding: 8px 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; height: 38px; width: 100px;"
                        onclick="uncheckPriceRadio()">
                    <button type="submit"
                        style="padding: 8px 12px; background: #3a5a40; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; height: 38px; width: 60px;">
                        검색
                    </button>
                </div>
            </div>
            
        </form>
    </section>
</aside>

		<!-- 우측: 인기 찜상품 + 최근 게시물 세로 배치 -->
		<main
			style="flex: 3; display: flex; flex-direction: column; gap: 2rem;">
			<!-- 인기 찜상품 섹션 -->
			<section class="popular-posts">
				<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
					<h2 class="section-title" style="margin-bottom: 0;">인기 찜상품</h2>
					<a href="/post/postList?sort=wishlist" class="more-link">
						찜 많은 순서대로 전체보기 →
					</a>
				</div>
				<div class="posts-grid"
					style="grid-template-columns: repeat(4, 1fr);">
					<div class="post-card" th:each="list: ${wishList}" 
					     th:classappend="${list.status == 'SOLD' ? 'sold' : ''}"
					     th:onclick="|location.href='/post/postView/' + ${list.postId}|" style="cursor: pointer;">
						<div class="post-image">
							<img th:if="${list.postImage != null and !list.postImage.isEmpty()}"
							     th:src="@{${#strings.arraySplit(list.postImage, ',')[0]}}" 
							     height="200" width="200">
							<span th:if="${list.postImage == null or list.postImage.isEmpty()}" 
							      style="display: flex; align-items: center; justify-content: center; height: 200px; font-size: 3rem;">📷</span>
						</div>
						<div class="post-content">
							<div class="post-title">[[${list.title}]]</div>
							<div class="post-location">
								<span>📍</span>
								<span>[[${list.location}]]</span>
							</div>
							<div class="post-price" th:classappend="${list.price == 0 ? 'free' : ''}">
								<span th:if="${list.price == 0}">나눔 💝</span>
								<span th:if="${list.price > 0}">[[${#numbers.formatInteger(list.price, 0, 'COMMA')}]]원</span>
							</div>
							<div class="post-wishlist">
								<span>♥</span>
								<span>[[${list.wishlistCount}]]</span>
							</div>
						</div>
					</div>
				</div>
			</section>


			<!-- 우측: 최근 게시물 -->
			<section class="recent-posts">
					<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
						<h2 class="section-title" style="margin-bottom: 0;">최근 등록된 상품</h2>
						<a href="/post/postList?sort=latest" class="more-link">
							최신 순서대로 더 보기 →
						</a>
					</div>
					<div class="posts-grid">
						<div class="post-card" th:each="list: ${latestList}" 
						     th:classappend="${list.status == 'SOLD' ? 'sold' : ''}"
						     th:onclick="|location.href='/post/postView/' + ${list.postId}|" style="cursor: pointer;">
							<div class="post-image">
								<img th:if="${list.postImage != null and !list.postImage.isEmpty()}"
								     th:src="@{${#strings.arraySplit(list.postImage, ',')[0]}}" 
								     height="200" width="200">
								<span th:if="${list.postImage == null or list.postImage.isEmpty()}" 
								      style="display: flex; align-items: center; justify-content: center; height: 200px; font-size: 3rem;">📷</span>
							</div>
							<div class="post-content">
								<div class="post-title">[[${list.title}]]</div>
								<div class="post-location">
									<span>📍</span>
									<span>[[${list.location}]]</span>
								</div>
								<div class="post-price" th:classappend="${list.price == 0 ? 'free' : ''}">
									<span th:if="${list.price == 0}">나눔 💝</span>
									<span th:if="${list.price > 0}">[[${#numbers.formatInteger(list.price, 0, 'COMMA')}]]원</span>
								</div>
								<div class="post-wishlist">
									<span>♥</span>
									<span>[[${list.wishlistCount}]]</span>
								</div>
							</div>
						</div>
					</div>
				</section>
			</main>
	</div>


	<div th:replace="~{layouts/footer.html}"></div>
	
	<script>
	// 페이지 로드 시 인트로 효과 실행 (세션당 1회만)
	document.addEventListener('DOMContentLoaded', function() {
		const introOverlay = document.getElementById('introOverlay');
		const mainContent = document.querySelector('.main-content');
		
		// 세션스토리지에서 인트로 표시 여부 확인
		const hasSeenIntro = sessionStorage.getItem('hasSeenIntro');
		
		if (hasSeenIntro) {
			// 이미 본 경우 인트로 바로 숨기기
			introOverlay.style.display = 'none';
			mainContent.classList.add('visible');
		} else {
			// 처음 보는 경우 인트로 표시
			sessionStorage.setItem('hasSeenIntro', 'true');
			
			// 2초 후 인트로 오버레이 숨기기
			setTimeout(function() {
				introOverlay.classList.add('hidden');
				
				// 0.5초 후 메인 콘텐츠 표시
				setTimeout(function() {
					mainContent.classList.add('visible');
					
					// 인트로 오버레이 완전 제거 (메모리 절약)
					setTimeout(function() {
						introOverlay.style.display = 'none';
					}, 500);
				}, 300);
			}, 2000);
		}
	});
	</script>
	
	<script src="/js/locationData.js"></script>
	
	<script>
		const sidoSelect = document.getElementById('sido');
		const sigunguSelect = document.getElementById('sigungu');
		const dongSelect = document.getElementById('dong');
		
		// 시/도 옵션 추가
		Object.keys(locationData).forEach(sido => {
		    const option = document.createElement('option');
		    option.value = sido;
		    option.textContent = sido;
		    sidoSelect.appendChild(option);
		});
		
		// 시/도 선택 시
		sidoSelect.addEventListener('change', function() {
		    sigunguSelect.innerHTML = '<option value="">시/군/구 선택</option>';
		    dongSelect.innerHTML = '<option value="">읍/면/동 선택</option>';
		    dongSelect.disabled = true;
		    
		    if (this.value) {
		        sigunguSelect.disabled = false;
		        Object.keys(locationData[this.value]).forEach(sigungu => {
		            const option = document.createElement('option');
		            option.value = sigungu;
		            option.textContent = sigungu;
		            sigunguSelect.appendChild(option);
		        });
		    } else {
		        sigunguSelect.disabled = true;
		    }
		});
		
		// 시/군/구 선택 시
		sigunguSelect.addEventListener('change', function() {
		    dongSelect.innerHTML = '<option value="">읍/면/동 선택</option>';
		    
		    if (this.value && sidoSelect.value) {
		        dongSelect.disabled = false;
		        locationData[sidoSelect.value][this.value].forEach(dong => {
		            const option = document.createElement('option');
		            option.value = dong;
		            option.textContent = dong;
		            dongSelect.appendChild(option);
		        });
		    } else {
		        dongSelect.disabled = true;
		    }
		});
		
	    // 가격대 라디오 버튼 클릭 시 직접 입력 필드에 값 설정
	    function setPriceRange(min, max) {
	        document.getElementById('minPrice').value = min;
	        document.getElementById('maxPrice').value = max;
	    }

	    // 전체보기 선택 시 가격 입력 필드 비우기
	    function disablePriceInput() {
	        document.getElementById('minPrice').value = '';
	        document.getElementById('maxPrice').value = '';
	    }

	    // 직접 가격 입력 시 라디오 버튼 해제
	    function uncheckPriceRadio() {
	        const radios = document.getElementsByName('priceRange');
	        radios.forEach(radio => radio.checked = false);
	    }
	    
	    // index 페이지 로드 시 검색 폼 초기화
	    window.addEventListener('DOMContentLoaded', function() {
	        // 제목 검색 초기화
	        document.querySelector('input[name="title"]').value = '';
	        
	        // 위치 선택 초기화
	        sidoSelect.value = '';
	        sigunguSelect.value = '';
	        sigunguSelect.disabled = true;
	        dongSelect.value = '';
	        dongSelect.disabled = true;
	        
	        // 카테고리 초기화 (전체보기 선택)
	        document.querySelector('input[name="category"][value=""]').checked = true;
	        
	        // 가격 초기화 (전체보기 선택)
	        document.querySelector('input[name="priceRange"][value="all"]').checked = true;
	        document.getElementById('minPrice').value = '';
	        document.getElementById('maxPrice').value = '';
	    });
	</script>
	
</body>
</html>